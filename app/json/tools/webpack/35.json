{"sta":1,"data":{"subTitle":"配置多环境变量","content":"<p>通过在 package.json 里的 scripts 配置项中添加--mode xxx 来选择不同环境\n\n  </p><p>只有以 VUE_APP 开头的变量会被 webpack.DefinePlugin 静态嵌入到客户端侧的包中，代码中可以通过 process.env.VUE_APP_BASE_API 访问\n\n  </p><p>NODE_ENV 和 BASE_URL 是两个特殊变量，在代码中始终可用&nbsp;</p><h3>&nbsp;配置\n\n  </h3><p>在项目根目录中新建.env, .env.production, .env.analyz 等文件&nbsp;</p><h4>&nbsp;.env\n  </h4><p>serve 默认的本地开发环境配置</p><pre><code>NODE_ENV = \"development\"\nBASE_URL = \"./\"\nVUE_APP_PUBLIC_PATH = \"./\"\nVUE_APP_API = \"https://test.staven630.com/api\"</code></pre><p><h4>.env.production\n</h4>build 默认的环境配置（正式服务器）</p><pre><code>NODE_ENV = \"production\"\nBASE_URL = \"https://prod.staven630.com/\"\nVUE_APP_PUBLIC_PATH = \"https://prod.oss.com/staven-blog\"\nVUE_APP_API = \"https://prod.staven630.com/api\"\n\nACCESS_KEY_ID = \"xxxxxxxxxxxxx\"\nACCESS_KEY_SECRET = \"xxxxxxxxxxxxx\"\nREGION = \"oss-cn-hangzhou\"\nBUCKET = \"staven-prod\"\nPREFIX = \"staven-blog\"</code></pre><p><h4>.env.crm\n</h4>自定义 build 环境配置（预发服务器）</p><pre><code>NODE_ENV = \"production\"\nBASE_URL = \"https://crm.staven630.com/\"\nVUE_APP_PUBLIC_PATH = \"https://crm.oss.com/staven-blog\"\nVUE_APP_API = \"https://crm.staven630.com/api\"\n\nACCESS_KEY_ID = \"xxxxxxxxxxxxx\"\nACCESS_KEY_SECRET = \"xxxxxxxxxxxxx\"\nREGION = \"oss-cn-hangzhou\"\nBUCKET = \"staven-crm\"\nPREFIX = \"staven-blog\"\n\nIS_ANALYZE = true;</code></pre><h4>修改 package.json</h4><pre><code>\"scripts\": {\n  \"build\": \"vue-cli-service build\",\n  \"crm\": \"vue-cli-service build --mode crm\"\n}</code></pre><h3>使用环境变量</h3><pre><code>&lt;template&gt;\n  &lt;div class=\"home\"&gt;\n    &lt;!-- template中使用环境变量 --&gt;\n     API: {{ api }}\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\nexport default {\n  name: \"home\",\n  data() {\n    return {\n      api: process.env.VUE_APP_API\n    };\n  },\n  mounted() {\n    // js代码中使用环境变量\n    console.log(\"BASE_URL: \", process.env.BASE_URL);\n    console.log(\"VUE_APP_API: \", process.env.VUE_APP_API);\n  }\n};\n&lt;/script&gt;</code></pre><p><br></p>"}}
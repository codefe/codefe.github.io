{"sta":1,"data":{"subTitle":"开启 gzip Zopfli 压缩","content":"<p></p><blockquote>npm i -D compression-webpack-plugin</blockquote><pre><code>const CompressionWebpackPlugin = require(\"compression-webpack-plugin\");\n\nconst IS_PROD = [\"production\", \"prod\"].includes(process.env.NODE_ENV);\nconst productionGzipExtensions = /\\.(js|css|json|txt|html|ico|svg)(\\?.*)?$/i;\n\nmodule.exports = {\n  configureWebpack: config =&gt; {\n    const plugins = [];\n    if (IS_PROD) {\n      plugins.push(\n        new CompressionWebpackPlugin({\n          filename: \"[path].gz[query]\",\n          algorithm: \"gzip\",\n          test: productionGzipExtensions,\n          threshold: 10240,\n          minRatio: 0.8\n        })\n      );\n    }\n    config.plugins = [...config.plugins, ...plugins];\n  }\n};</code></pre><p>还可以开启比 gzip 体验更好的 Zopfli 压缩详见https://webpack.js.org/plugins/compression-webpack-plugin</p><blockquote>npm i -D @gfx/zopfli brotli-webpack-plugin</blockquote><pre><code>const CompressionWebpackPlugin = require(\"compression-webpack-plugin\");\nconst zopfli = require(\"@gfx/zopfli\");\nconst BrotliPlugin = require(\"brotli-webpack-plugin\");\n\nconst IS_PROD = [\"production\", \"prod\"].includes(process.env.NODE_ENV);\nconst productionGzipExtensions = /\\.(js|css|json|txt|html|ico|svg)(\\?.*)?$/i;\n\nmodule.exports = {\n  configureWebpack: config =&gt; {\n    const plugins = [];\n    if (IS_PROD) {\n      plugins.push(\n        new CompressionWebpackPlugin({\n          algorithm(input, compressionOptions, callback) {\n            return zopfli.gzip(input, compressionOptions, callback);\n          },\n          compressionOptions: {\n            numiterations: 15\n          },\n          minRatio: 0.99,\n          test: productionGzipExtensions\n        })\n      );\n      plugins.push(\n        new BrotliPlugin({\n          test: productionGzipExtensions,\n          minRatio: 0.99\n        })\n      );\n    }\n    config.plugins = [...config.plugins, ...plugins];\n  }\n};</code></pre><p><br></p>"}}
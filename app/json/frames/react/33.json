{"sta":1,"data":{"subTitle":"首次执行时 useEffect 的时机","content":"<p>核心知识点 函数首次执行时 useEffect 的副作用的依赖参数为 false 还会执行吗？useEffect 第二个参数表示发生变化后执行第一个函数，即使设置初始值为 false，DOM 初次渲染完以后也会执行 useEffect。\n\n如下代码，即使 flag 为 false，首次执行函数也会执行 useEffect&nbsp;</p><p>&nbsp;示例</p><pre>const MyDemo8 = () =&gt; {\n  const [flag, setFlag] = useState(false);\n  useEffect(() =&gt; {\n    console.log(\"执行了effect\", flag); //即使一开始是false，渲染完dom后也会执行该副作用\n  }, [flag]);\n  const changeFlag = () =&gt; {\n    setFlag(true);\n  };\n  return (\n    &lt;div className=\"container\"&gt;\n      {console.log(\"渲染了组件\")}\n      &lt;div&gt;页面flag{flag}&lt;/div&gt;\n      &lt;button onClick={changeFlag}&gt;点击我切换flag&lt;/button&gt;\n    &lt;/div&gt;\n  );\n};</pre><p>结果示例</p><p><img src=\"/app/json/frames/react/img/r3.gif\" style=\"max-width:100%;\"></p><p>如上图所示，即使刚开始我们设置了 flag 为 false，useEffect 也会在 render 之后执行一次，所以如果我们并不想让其一开始就执行的话，需要在 useEffect 中增加条件判断：</p><pre>const MyDemo9 = () =&gt; {\n  const [flag, setFlag] = useState(false);\n  useEffect(() =&gt; {\n    flag &amp;&amp; console.log(\"执行了effect\", flag); //即使一开始是false，渲染完dom后也会执行该副作用\n  }, [flag]);\n  const changeFlag = () =&gt; {\n    setFlag(true);\n  };\n  return (\n    &lt;div className=\"container\"&gt;\n      {console.log(\"渲染了组件\")}\n      &lt;div&gt;页面flag{flag}&lt;/div&gt;\n      &lt;button onClick={changeFlag}&gt;点击我切换flag&lt;/button&gt;\n    &lt;/div&gt;\n  );\n};</pre><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p>"}}
{"sta":1,"data":{"subTitle":"页面卸载","content":"<p>下面专门讨论一下，如何正确监听页面卸载。</p><p></p><p>页面卸载可以分成三种情况。</p><pre><code>页面可见时，用户关闭 Tab 页或浏览器窗口。\n页面可见时，用户在当前窗口前往另一个页面。\n页面不可见时，用户或系统关闭浏览器窗口。</code></pre><p>这三种情况，都会触发visibilitychange事件。前两种情况，该事件在用户离开页面时触发；最后一种情况，该事件在页面从可见状态变为不可见状态时触发。\n<br>\n<br>由此可见，visibilitychange事件比pagehide、beforeunload、unload事件更可靠，所有情况下都会触发（从visible变为hidden）。因此，可以只监听这个事件，运行页面卸载时需要运行的代码，不用监听后面那三个事件。\n<br>\n<br>甚至可以这样说，unload事件在任何情况下都不必监听，beforeunload事件只有一种适用场景，就是用户修改了表单，没有提交就离开当前页面。另一方面，指定了这两个事件的监听函数，浏览器就不会缓存当前页面。</p>"}}
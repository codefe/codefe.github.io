{"sta":1,"data":{"subTitle":"xlsx使用","content":"<p>安装</p><blockquote>npm i xlsx -S</blockquote><p>读取数据</p><pre>let xlsx = require('xlsx');\nlet workbook = xlsx.readFile('susu.xlsx'); //workbook就是xls文档对象\nlet sheetNames = workbook.SheetNames; //获取表明\nlet sheet = workbook.Sheets[sheetNames[0]]; //通过表明得到表对象\nvar data =xlsx.utils.sheet_to_json(sheet); //通过工具将表对象的数据读出来并转成json</pre><p>写数据<br></p><pre>let xlsx = require('xlsx');\nlet json = [ \n    {\"大标题\":null},\n    {null:\"大标题\"},\n    {null:\"大标题\"},\n    {null:\"大标题\"},\n    { Name: 'name_01', Age: 21, Address: 'address_01' },\n    { Name: 'name_02', Age: 22, Address: 'address_02' },\n    { Name: 'name_03', Age: 23, Address: 'address_03' },\n    { Name: 'name_04', Age: 24, Address: 'address_04' },\n    { Name: 'name_05', Age: 25, Address: 'address_05' }, ];\n\nlet ss = xlsx.utils.json_to_sheet(json); //通过工具将json转表对象\nlet keys = Object.keys(ss).sort(); //排序 [需要注意，必须从A1开始]\n\nlet ref = keys[1]+':'+keys[keys.length - 1]; //这个是定义一个字符串 也就是表的范围[A1:C5] \n\nlet workbook = { //定义操作文档\n    SheetNames:['nodejs-sheetname'], //定义表明\n    Sheets:{\n        'nodejs-sheetname':Object.assign({},ss,{'!ref':ref}) //表对象[注意表明]\n    },\n}\n\nxlsx.writeFile(workbook,\"./suzhenwei.xls\"); //将数据写入文件</pre><p><br></p>"}}
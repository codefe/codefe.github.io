{"sta":1,"data":{"subTitle":"前端js实现打印/导出excel表格","content":"<pre><code>&lt;button type=\"button\" class=\"btn green\" id=\"excell\" onclick=\"method5('dataTable')\"&gt;导出考勤表格&lt;/button&gt;</code></pre><pre><code>&lt;script&gt;\n        //打印表格\n        var idTmr;\n\n        function getExplorer() {\n            var explorer = window.navigator.userAgent;\n            //ie  \n            if(explorer.indexOf(\"MSIE\") &gt;= 0) {\n                return 'ie';\n            }\n            //firefox  \n            else if(explorer.indexOf(\"Firefox\") &gt;= 0) {\n                return 'Firefox';\n            }\n            //Chrome  \n            else if(explorer.indexOf(\"Chrome\") &gt;= 0) {\n                return 'Chrome';\n            }\n            //Opera  \n            else if(explorer.indexOf(\"Opera\") &gt;= 0) {\n                return 'Opera';\n            }\n            //Safari  \n            else if(explorer.indexOf(\"Safari\") &gt;= 0) {\n                return 'Safari';\n            }\n        }\n\n        function method5(tableid) {\n            if(getExplorer() == 'ie') {\n                var curTbl = document.getElementById(tableid);\n                var oXL = new ActiveXObject(\"Excel.Application\");\n                var oWB = oXL.Workbooks.Add();\n                var xlsheet = oWB.Worksheets(1);\n                var sel = document.body.createTextRange();\n                sel.moveToElementText(curTbl);\n                sel.select();\n                sel.execCommand(\"Copy\");\n                xlsheet.Paste();\n                oXL.Visible = true;\n\n                try {\n                    var fname = oXL.Application.GetSaveAsFilename(\"Excel.xls\",\n                        \"Excel Spreadsheets (*.xls), *.xls\");\n                } catch(e) {\n                    print(\"Nested catch caught \" + e);\n                } finally {\n                    oWB.SaveAs(fname);\n                    oWB.Close(savechanges = false);\n                    oXL.Quit();\n                    oXL = null;\n                    idTmr = window.setInterval(\"Cleanup();\", 1);\n                }\n\n            } else {\n                tableToExcel(tableid)\n            }\n        }\n\n        function Cleanup() {\n            window.clearInterval(idTmr);\n            CollectGarbage();\n        }\n        var tableToExcel = (function() {\n            var uri = 'data:application/vnd.ms-excel;base64,',\n                template = '&lt;html&gt;&lt;head&gt;&lt;meta charset=\"UTF-8\"&gt;&lt;/head&gt;&lt;body&gt;&lt;table  border=\"1\"&gt;{table}&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;',\n                base64 = function(\n                    s) {\n                    return window.btoa(unescape(encodeURIComponent(s)))\n                },\n                format = function(s, c) {\n                    return s.replace(/{(\\w+)}/g, function(m, p) {\n                        return c[p];\n                    })\n                }\n            return function(table, name) {\n                if(!table.nodeType)\n                    table = document.getElementById(table)\n                var ctx = {\n                    worksheet: name || 'Worksheet',\n                    table: table.innerHTML\n                }\n                window.location.href = uri + base64(format(template, ctx))\n            }\n        })()\n    &lt;/script&gt;</code></pre><p><br></p>"}}
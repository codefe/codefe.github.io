{"sta":1,"data":{"subTitle":"读取内容的方法","content":"<p><code>Response</code>对象根据服务器返回的不同类型的数据，提供了不同的读取方法。<br></p><pre><code>response.text()：得到文本字符串。\nresponse.json()：得到 JSON 对象。\nresponse.blob()：得到二进制 Blob 对象。\nresponse.formData()：得到 FormData 表单对象。\nresponse.arrayBuffer()：得到二进制 ArrayBuffer 对象。</code></pre><p>上面5个读取方法都是异步的，返回的都是 Promise 对象。必须等到异步操作结束，才能得到服务器返回的完整数据。</p><p><h3>response.text()</h3>response.text()可以用于获取文本数据，比如 HTML 文件。<br><blockquote>const response = await fetch('/users.html');<br>\nconst body = await response.text();<br>\ndocument.body.innerHTML = body</blockquote></p><p><h3>&nbsp;response.json()</h3>response.json()主要用于获取服务器返回的 JSON 数据，前面已经举过例子了。<br><h3>response.formData()</h3>response.formData()主要用在 Service Worker 里面，拦截用户提交的表单，修改某些数据以后，再提交给服务器。\n<br>\n<br><h3>response.blob()</h3>response.blob()用于获取二进制文件。\n<br><br><blockquote>const response = await fetch('flower.jpg');<br>\nconst myBlob = await response.blob();<br>\nconst objectURL = URL.createObjectURL(myBlob);\n<br>const myImage = document.querySelector('img');<br>\nmyImage.src = objectURL;\n</blockquote>\n上面示例读取图片文件flower.jpg，显示在网页上。<br><h3>response.arrayBuffer()</h3>response.arrayBuffer()主要用于获取流媒体文件。\n<br><br><blockquote>const audioCtx = new window.AudioContext();<br>\nconst source = audioCtx.createBufferSource();\n<br>const response = await fetch('song.ogg');<br>\nconst buffer = await response.arrayBuffer();\n<br>const decodeData = await audioCtx.decodeAudioData(buffer);<br>\nsource.buffer = buffer;<br>\nsource.connect(audioCtx.destination);<br>\nsource.loop = true;\n</blockquote>\n\n上面示例是response.arrayBuffer()获取音频文件song.ogg，然后在线播放的例子。</p>"}}